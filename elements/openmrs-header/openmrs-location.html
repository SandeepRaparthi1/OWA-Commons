<link rel="import" href="/bower_components/polymer/polymer.html">
<link rel="import" href="/bower_components/iron-ajax/iron-ajax.html">
<link rel="stylesheet" type="text/css" href="/css/main.css">
<dom-module id="openmrs-location">
    <template>        
        <iron-ajax auto url="http://demo.openmrs.org/openmrs/ws/rest/v1/location/aff27d58-a15c-49a6-9beb-d30dcfc0c66e"
        on-response="handleResponse"></iron-ajax>
        <a href="#" on-click="showlocations">
                <i class="icon-map-marker small"></i>
                 <span id="currentlocation"></span>                
                <i id="icon" class="icon-caret-down link" ></i>                               
        </a>
        <div id="session-location" style="display: none;">        
        <ul class="select">          
            <li class="" id="loc1" on-click="setlocationtoloc1"></li>            
            <li class="" id="loc2" on-click="setlocationtoloc2"></li>
            <li class="" id="loc3" on-click="setlocationtoloc3"></li>            
            <li class="" id="loc4" on-click="setlocationtoloc4"></li>
            <li class="" id="loc5" on-click="setlocationtoloc5"></li>
            <li class="" id="loc6" on-click="setlocationtoloc6"></li>           
        </ul>
        </div>
    </template>    
</dom-module>
<script>
    Polymer({
        is: "openmrs-location",  
        handleResponse: function (request) {                             
            var objarray = new Array();
            objarray =  request.detail.response.childLocations;                                  
            this.$.loc1.textContent=objarray[0].display;
            this.$.loc2.textContent=objarray[1].display;
            this.$.loc3.textContent=objarray[2].display; 
            this.$.loc4.textContent=objarray[3].display;
            this.$.loc5.textContent=objarray[4].display;
            this.$.loc6.textContent=objarray[5].display;        
                  
        },
        showlocations:function()
        {
        var div = document.getElementById('session-location');       
        div.style.display = 'block';          
        document.getElementById('icon').setAttribute("class", "icon-caret-up link"); 
        },
        setlocationtoloc1:function()
        {        	
        	this.$.currentlocation.textContent=this.$.loc1.textContent;
        	var div = document.getElementById('session-location');       
            div.style.display = 'none';
            document.getElementById('icon').setAttribute("class", "icon-caret-down link");
        },
        setlocationtoloc2:function()
        {        	
        	this.$.currentlocation.textContent=this.$.loc2.textContent;
        	var div = document.getElementById('session-location');       
            div.style.display = 'none';
            document.getElementById('icon').setAttribute("class", "icon-caret-down link");
        },
        setlocationtoloc3:function()
        {        	
        	this.$.currentlocation.textContent=this.$.loc3.textContent;
        	var div = document.getElementById('session-location');       
            div.style.display = 'none';
            document.getElementById('icon').setAttribute("class", "icon-caret-down link");
        },
        setlocationtoloc4:function()
        {        	
        	this.$.currentlocation.textContent=this.$.loc4.textContent;
        	var div = document.getElementById('session-location');       
            div.style.display = 'none';
            document.getElementById('icon').setAttribute("class", "icon-caret-down link");
        },
        setlocationtoloc5:function()
        {        	
        	this.$.currentlocation.textContent=this.$.loc5.textContent;
        	var div = document.getElementById('session-location');       
            div.style.display = 'none';
            document.getElementById('icon').setAttribute("class", "icon-caret-down link");
        },
        setlocationtoloc6:function()
        {        	
        	this.$.currentlocation.textContent=this.$.loc6.textContent;
        	var div = document.getElementById('session-location');       
            div.style.display = 'none';
            document.getElementById('icon').setAttribute("class", "icon-caret-down link");
        }
    });
</script> 


