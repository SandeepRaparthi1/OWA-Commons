<link rel="import" href="/bower_components/polymer/polymer.html">
<link rel="import" href="/bower_components/iron-form/iron-form.html">
<link rel="stylesheet" type="text/css" href="/css/main.css">

<dom-module id="registration-form">
   <template>   
    <h2>
        Register a patient
    </h2>
    <iron-ajax 
    id="ajax"    
    url="http://demo.openmrs.org/openmrs/ws/rest/v1/patient"  
    method="POST"  
    handle-as="json"
    on-response="handleResponse">
    </iron-ajax>
    <form is="iron-form" method="get" class="simple-form-ui" id="registration" on-iron-form-submit="makeajax">
        <ul id="formBreadcrumb" class="options">
            <li class="doing"><span id="demographics_label">Demographics</span>
                <ul>
                    <li id="nameLabel" class="question-legend focused"><i class="icon-ok"></i><span>Name</span></li>
                    <li id="genderLabel" class="question-legend"><i class="icon-ok"></i><span>Gender</span></li>
                    <li id="birthdateLabel" class="question-legend"><i class="icon-ok"></i><span >Birthdate</span></li>
                </ul>
            </li>            
            <li>
                <span id="confirmation_label">Confirm</span>
            </li>
        </ul>
        <section id="demographics" class="non-collapsible focused">
            <fieldset id="demographics-name" class="focused">
                <legend>Name</legend>
                <div>
                    <h3>What's the patient's name?</h3>
                    <p class="left">
                        <label for="fr7057-field">Given <span>(required)</span>
                        </label>
                        <input type="text" id="fr7057-field" name="givenName" value="" class="required focused ui-autocomplete-input" autocomplete="off">
                        <span role="status" aria-live="polite" class="ui-helper-hidden-accessible">
                        </span>
                        <span id="fr393" class="field-error" style="display: none">Required</span>
                    </p>
                    <p class="left">
                        <label for="fr2890-field">Middle</label>
                        <input type="text" id="fr2890-field" name="middleName" value="" class="ui-autocomplete-input" autocomplete="off">
                        <span role="status" aria-live="polite" class="ui-helper-hidden-accessible"></span>
                        <span id="fr5051" class="field-error" style="display: none"></span>
                    </p>
                    <p class="left">
                        <label for="fr905-field">Family Name <span>(required)</span>
                        </label>
                        <input type="text" id="fr905-field" name="familyName" value="" class="required ui-autocomplete-input" autocomplete="off" on-keyup="movetogenderfield">
                        <span role="status" aria-live="polite" class="ui-helper-hidden-accessible"></span>
                        <span id="fr6684" class="field-error" style="display: none">Required</span>
                    </p>
                </div>
                <div style="display:inline-block">
                    <nobr>
                        <input id="checkbox-unknown-patient" type="checkbox">
                        <label for="checkbox-unknown-patient">Unidentified Patient</label>
                    </nobr>
                </div>
                <input type="hidden" name="preferred" value="true">
            </fieldset>
            <fieldset id="demographics-gender">
                <legend id="genderLabel">Gender</legend>
                <h3>What's the patient's gender?</h3>
                <p id="gender">
                    <label for="gender-field">
                        <span>(required)</span>
                    </label>
                    <select id="gender-field" name="gender" class="required" size="2" data-bind=",value: gender">
                        <option value="M">Male</option>
                        <option value="F">Female</option>
                    </select>
                    <span id="fr4195" class="field-error" style="display: none"></span>
                </p>
                <input id="demographics-unknown" type="hidden" name="unknown" value="false">
            </fieldset>
            <fieldset id="demographics-birthdate" class="multiple-input-date date-required no-future-date">
                <legend id="birthdateLabel">Birthdate</legend>
                <h3>What's the patient's birth date?</h3>
                <p id="fr6003">
                    <span id="fr433" class="field-error" style="display: none"></span>
                </p>
                <p class="left">
                    <label for="birthdateDay-field">Day</label>
                    <input type="text" id="birthdateDay-field" name="birthdateDay" value="" class="day number numeric-range date-component" size="5" maxlength="2" min="1" max="31">
                    <span id="fr4628" class="field-error" style="display: none"></span>
                </p>             
                <p id="birthdateMonth" class="left">
                    <label for="birthdateMonth-field">Month</label>  
                    <select id="birthdateMonth-field" name="birthdateMonth" class="month date-component">     
                        <option value="">Select</option>
                        <option value="1">January</option>
                        <option value="2">February</option>
                        <option value="3">March</option>
                        <option value="4">April</option>
                        <option value="5">May</option>
                        <option value="6">June</option>
                        <option value="7">July</option>
                        <option value="8">August</option>
                        <option value="9">September</option>
                        <option value="10">October</option>
                        <option value="11">November</option>
                        <option value="12">December</option>
                    </select>
                    <span id="fr6483" class="field-error" style="display: none"></span>
                </p>
                <p class="left">
                    <label for="birthdateYear-field">Year</label>
                    <input type="text" id="birthdateYear-field" name="birthdateYear" value="" class="year number numeric-range date-component" size="5" maxlength="4" min="1895" max="2015">
                    <span id="fr5519" class="field-error" style="display: none"></span>
                </p>
                <div class="clear">
                <p></p>
                <p>&nbsp;</p>
                <h3>Or</h3>
                <p>
                </p><p class="left">
                <label for="birthdateYears-field">Estimated Years</label>
                <input type="text" id="birthdateYears-field" name="birthdateYears" value="" class="years number numeric-range date-component" maxlength="3" min="0" max="120">
                <span id="fr8972" class="field-error" style="display: none"></span>
                <span class="append-to-value hidden"> year(s)</span>
                </p>
                <p class="left">
                <label for="birthdateMonths-field">Estimated Months</label>
                <input type="text" id="birthdateMonths-field" name="birthdateMonths" value="" class="months number numeric-range date-component" maxlength="2" min="0" max="11">
                <span id="fr4751" class="field-error" style="display: none"></span>
                <span class="append-to-value hidden"> month(s)</span>
                </p>
                <p></p>
                <input id="birthdate-value" type="hidden" name="birthdate">
                </div>
            </fieldset>
        </section>
        <div id="confirmation">
            <div class="before-dataCanvas"></div>
            <div id="dataCanvas"></div>
            <div class="after-data-canvas"></div>
            <div id="confirmationQuestion">
                Confirm submission?
                <p style="display: inline">
                    <input id="submit" type="submit" class="submitButton confirm right" value="Confirm">
                </p>
                <p style="display: inline">
                    <input id="cancelSubmission" class="cancel" type="button" value="Cancel">
                </p>
            </div>
        </div>
    </form>
  </template>
</dom-module>

<script>
  Polymer ({
     is: "registration-form",          
     makeajax:function()
     {        
      this.$.ajax.params = {};     
      this.$.ajax.generateRequest();
     },     
     movetogenderfield:function()
     {        
        document.getElementById('demographics-name').setAttribute("class", "");
        document.getElementById('demographics-gender').setAttribute("class", "focused");        
        document.getElementById('nameLabel').setAttribute("class", "question-legend done");
        document.getElementById('genderLabel').setAttribute("class", "question-legend focused");                  
     }
  });
</script>
